<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Lab 2 ‚Äì URL & Domain Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f5f7fb;
      color: #1f2937;
    }
    .lab-hero {
      background: linear-gradient(135deg, rgba(31, 111, 235, 0.12), rgba(128, 70, 245, 0.2));
      border-radius: 1rem;
      padding: 2.5rem;
    }
    .lab-step {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 1rem 2rem rgba(15, 23, 42, 0.08);
      margin-bottom: 2rem;
      display: none;
    }
    .lab-step.active {
      display: block;
    }
    .lab-step h2 {
      font-size: 1.35rem;
    }
    .email-example {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 0.75rem 1.5rem rgba(15, 23, 42, 0.06);
      overflow: hidden;
    }
    .email-header {
      background: linear-gradient(135deg, #1f6feb, #8046f5);
      color: #fff;
      padding: 1.25rem;
    }
    .email-body {
      padding: 1.5rem;
    }
    .flag-pill {
      background: rgba(14, 165, 233, 0.12);
      border-left: 4px solid #0ea5e9;
      border-radius: 0.75rem;
      padding: 0.75rem 1rem;
    }
    .indicator-card {
      background: #fff;
      border-radius: 0.75rem;
      border: 1px solid #e5e7eb;
      padding: 1.25rem;
      box-shadow: 0 0.5rem 1rem rgba(15, 23, 42, 0.05);
    }
    .indicator-card .form-check {
      margin-bottom: 0.5rem;
    }
    .indicator-status {
      font-weight: 600;
      color: #1f2937;
    }
    details summary {
      cursor: pointer;
      font-weight: 600;
    }
    .portal-preview {
      border: 1px dashed #cbd5f5;
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
      background: #fff;
    }
    .portal-preview img {
      max-width: 100%;
      border-radius: 0.75rem;
      box-shadow: 0 1rem 2rem rgba(15, 23, 42, 0.12);
    }
    .artefact-tabs {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin: 1.5rem 0 1rem;
    }
    .artefact-tab {
      border-radius: 999px;
      border: 1px solid #cbd5f5;
      padding: 0.45rem 1.1rem;
      background: #f8f9ff;
      color: #1f2937;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    .artefact-tab.active {
      background: #1f6feb;
      color: #fff;
      border-color: #1f6feb;
      box-shadow: 0 0.5rem 1rem rgba(31, 111, 235, 0.2);
    }
    .artefact-tab:focus-visible {
      outline: none;
      box-shadow: 0 0 0 3px rgba(31, 111, 235, 0.35);
    }
    .artefact-panel {
      display: none;
      background: #fff;
      border-radius: 0.75rem;
      border: 1px solid #e5e7eb;
      padding: 1.25rem;
      box-shadow: 0 0.5rem 1rem rgba(15, 23, 42, 0.05);
    }
    .artefact-panel.active {
      display: block;
    }
    .knowledge-card {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 0.75rem 1.5rem rgba(15, 23, 42, 0.06);
    }
    .knowledge-card details {
      border-top: 1px solid #e5e7eb;
      padding-top: 1rem;
      margin-top: 1rem;
    }
    .mcq-form {
      border: 1px solid #e5e7eb;
      border-radius: 0.75rem;
      padding: 1rem 1.25rem;
      background: #f9fafc;
    }
    .mcq-form .form-check {
      margin-bottom: 0.5rem;
    }
    .mcq-feedback {
      min-height: 1.5rem;
      font-weight: 600;
    }
    .mcq-feedback.correct {
      color: #198754;
    }
    .mcq-feedback.incorrect {
      color: #dc3545;
    }
    .flag-banner {
      background: rgba(25, 135, 84, 0.12);
      border-left: 4px solid #198754;
      border-radius: 0.75rem;
      padding: 1rem 1.25rem;
      font-weight: 600;
      color: #0f5132;
    }
    .progress-tracker {
      background: #fff;
      border-radius: 0.75rem;
      box-shadow: 0 0.75rem 1.5rem rgba(15, 23, 42, 0.08);
      padding: 1.25rem;
      margin-bottom: 2rem;
    }
    .tracker-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 0.35rem;
      color: #94a3b8;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      border: none;
      background: transparent;
      padding: 0;
      -webkit-appearance: none;
      appearance: none;
    }
    .tracker-circle {
      width: 2.25rem;
      height: 2.25rem;
      border-radius: 50%;
      display: grid;
      place-items: center;
      border: 2px solid #cbd5f5;
      background: #f8f9ff;
      font-weight: 600;
    }
    .tracker-step.active {
      color: #1f2937;
      cursor: default;
    }
    .tracker-step:focus {
      outline: none;
    }
    .tracker-step:focus-visible .tracker-circle {
      box-shadow: 0 0 0 4px rgba(31, 111, 235, 0.35);
    }
    .tracker-step.active .tracker-circle {
      border-color: #1f6feb;
      background: #1f6feb;
      color: #fff;
      box-shadow: 0 0.5rem 1rem rgba(31, 111, 235, 0.25);
    }
    .tracker-step.completed .tracker-circle {
      border-color: #1f6feb;
      background: rgba(31, 111, 235, 0.12);
      color: #1f6feb;
    }
    .step-nav {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      justify-content: space-between;
      margin-top: 1.5rem;
    }
    .step-nav .btn {
      flex: 1;
      min-width: 10rem;
    }
    @media (max-width: 576px) {
      .step-nav {
        flex-direction: column;
      }
      .step-nav .btn {
        width: 100%;
      }
    }
    .lab-modules .module-card {
      background: #fff;
      border-radius: 1rem;
      box-shadow: 0 1rem 2rem rgba(15, 23, 42, 0.08);
      margin-bottom: 2rem;
      overflow: hidden;
    }
    .module-card img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .module-body {
      padding: 1.75rem;
    }
    footer {
      color: #6b7280;
    }
  </style>
</head>
<body>
  <div class="container py-4">
    <header class="lab-hero mb-5">
      <div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-4">
        <div>
          <h1 class="display-6 fw-semibold mb-2">Lab 2 ‚Äì URL & Domain Analysis</h1>
          <p class="mb-0 lead text-secondary">Examine a suspicious payment notice, validate the destination infrastructure, and log the completion flag.</p>
        </div>
        <a class="btn btn-outline-light text-dark bg-white" href="index.html">‚Üê Back to Lab Index</a>
      </div>
    </header>

    <nav class="progress-tracker d-flex align-items-center justify-content-between gap-3 flex-column flex-md-row text-center" aria-label="Lab progression">
      <button type="button" class="tracker-step active" data-step="1" aria-current="step">
        <span class="tracker-circle">1</span>
        <span>Scenario Brief</span>
      </button>
      <button type="button" class="tracker-step" data-step="2">
        <span class="tracker-circle">2</span>
        <span>URL Artefacts</span>
      </button>
      <button type="button" class="tracker-step" data-step="3">
        <span class="tracker-circle">3</span>
        <span>Assessment</span>
      </button>
    </nav>

    <section class="lab-step active p-4" id="step-1" data-step="1">
      <div class="row g-4 align-items-start">
        <div class="col-lg-6">
          <h2 class="fw-semibold">Step 1 ¬∑ Scenario Brief</h2>
          <p class="text-secondary">Review the incident summary used throughout this lab. Each multiple-choice question references details from the message and investigation notes.</p>
          <p class="text-secondary">Finance analyst Priya receives a payment failure alert that claims to be from a long-term vendor. The message insists a new portal link must be used within the hour to avoid shipment delays. Hovering the button shows an unfamiliar host, and the attached WHOIS lookup reveals the domain was registered this week.</p>
          <details class="mt-3">
            <summary>Key facts to remember</summary>
            <div class="flag-pill mt-3">
              üîç Sender: <strong>invoices@northwind-payments.co</strong> ‚Äî expected domain is <code>northwind-payments.com</code>.
            </div>
            <div class="flag-pill mt-2">
              üîç Hover URL: <code class="d-inline">https://portal-northwind.co/update?id=8734&amp;session=secure</code>.
            </div>
            <div class="flag-pill mt-2">
              üîç WHOIS registration date: <strong>7 days ago</strong> with privacy-protected registrant.
            </div>
          </details>
          <div class="indicator-card mt-4" aria-labelledby="indicator-heading">
            <h3 class="h6 mb-3" id="indicator-heading">Log the red flags you spot</h3>
            <div class="form-check">
              <input class="form-check-input indicator-check" type="checkbox" id="indicator-domain" data-label="Domain mismatch">
              <label class="form-check-label" for="indicator-domain">Sender domain swaps <code>.com</code> for <code>.co</code>.</label>
            </div>
            <div class="form-check">
              <input class="form-check-input indicator-check" type="checkbox" id="indicator-deadline" data-label="Urgent deadline">
              <label class="form-check-label" for="indicator-deadline">Email pressures completion within 60 minutes.</label>
            </div>
            <div class="form-check">
              <input class="form-check-input indicator-check" type="checkbox" id="indicator-whois" data-label="Fresh registration">
              <label class="form-check-label" for="indicator-whois">WHOIS lookup shows the domain registered this week.</label>
            </div>
            <p class="indicator-status small mt-3" aria-live="polite"></p>
          </div>
        </div>
        <div class="col-lg-6">
          <div class="email-example">
            <div class="email-header">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <h3 class="h5 mb-1">Immediate Payment Portal Update Required</h3>
                  <p class="small mb-0">From: invoices@northwind-payments.co</p>
                </div>
                <span class="badge bg-warning text-dark">Investigate</span>
              </div>
            </div>
            <div class="email-body">
              <p>Hi Priya,</p>
              <p>Our processing gateway was recently upgraded. To release the pending invoices, confirm the new settlement portal within the next <strong>60 minutes</strong>.</p>
              <p class="mb-3">Use the secure link below with your vendor credentials. Delays will impact the Q2 shipment.</p>
              <p class="mb-3">
                <button type="button" class="btn btn-primary btn-sm jump-step" data-target="2">Open URL Artefacts</button>
              </p>
              <p>If you cannot access the link immediately, reply with your account ID so we can manually verify.</p>
              <p class="mb-0">Regards,<br>Monica Patel<br>Northwind Payments</p>
              <hr>
              <p class="small text-secondary mb-1">Header excerpt:</p>
              <code class="d-block p-3 bg-dark text-white rounded">Return-Path: &lt;mailer@portal-northwind.co&gt;
Received: from 185.199.110.94 (reverse lookup fails)
Authentication-Results: spf=softfail smtp.mailfrom=portal-northwind.co
X-LinkScan: new-domain alert triggered
              </code>
            </div>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button type="button" class="btn btn-outline-secondary btn-sm disabled" aria-disabled="true" disabled>Back</button>
        <button type="button" class="btn btn-primary btn-sm next-step" data-next="2">Continue to URL Artefacts</button>
      </div>
    </section>

    <section class="lab-step p-4" id="step-2" data-step="2">
      <div class="row g-4 align-items-center">
        <div class="col-lg-6 order-lg-2">
          <h2 class="fw-semibold">Step 2 ¬∑ URL Artefacts</h2>
          <p class="text-secondary">Analyse the captured browser view and supporting notes. Use the interactive artefact tabs to compare what you observe with the legitimate vendor portal.</p>
          <div class="artefact-tabs" role="tablist" aria-label="URL artefact explorer">
            <button type="button" class="artefact-tab active" data-panel="panel-address" aria-controls="panel-address" aria-pressed="true">Address Bar &amp; Certificate</button>
            <button type="button" class="artefact-tab" data-panel="panel-redirect" aria-controls="panel-redirect" aria-pressed="false">Redirect Trace</button>
            <button type="button" class="artefact-tab" data-panel="panel-dns" aria-controls="panel-dns" aria-pressed="false">Domain Intelligence</button>
          </div>
          <div class="artefact-panel active" id="panel-address" role="region" aria-labelledby="panel-address-label">
            <h3 class="h6" id="panel-address-label">Address bar comparison</h3>
            <p class="text-secondary mb-2">The suspicious page loads at <strong>https://portal-northwind.co</strong> with a DV certificate issued by <em>Let's Encrypt</em>. The certificate subject lists privacy-shielded contact details rather than Northwind Payments.</p>
            <div class="flag-pill mt-3">Legitimate portal: <code>https://secure.northwind-payments.com</code> with an EV certificate that displays the company name.</div>
          </div>
          <div class="artefact-panel" id="panel-redirect" role="region" aria-labelledby="panel-redirect-label">
            <h3 class="h6" id="panel-redirect-label">Redirect behaviour</h3>
            <p class="text-secondary mb-2">Developer tools reveal the CTA button forwards to <code>http://198.51.100.43/login</code> after the initial load. The downgrade to HTTP removes TLS protection and exposes any credentials or card data entered.</p>
            <div class="flag-pill mt-3">Link inspector highlights: chained redirect, mixed-content warning, credential capture script initialises once redirected.</div>
          </div>
          <div class="artefact-panel" id="panel-dns" role="region" aria-labelledby="panel-dns-label">
            <h3 class="h6" id="panel-dns-label">Passive DNS &amp; registration</h3>
            <p class="text-secondary mb-2">Passive DNS records show <code>portal-northwind.co</code> first resolving three days ago to infrastructure reused by blocked phishing kits. WHOIS data hides the registrant and lists privacy-shielded contacts.</p>
            <ul class="text-secondary mb-0">
              <li>Legitimate portal lists corporate IT contacts and has been active for 4 years.</li>
              <li>TLS fingerprint mismatches the legitimate JA3 hash observed in baseline monitoring.</li>
            </ul>
          </div>
          <p class="artefact-status small mt-3" aria-live="polite"></p>
        </div>
        <div class="col-lg-6 order-lg-1">
          <div class="portal-preview">
            <p class="text-muted mb-3">Captured browser preview</p>
            <img src="https://images.unsplash.com/photo-1498050108023-c5249f4df085?auto=format&fit=crop&w=900&q=80" alt="Browser window showing suspicious payment portal">
            <p class="small text-secondary mt-3 mb-0">Focus on the URL bar, certificate information, and the redirect notice in the developer console.</p>
          </div>
        </div>
      </div>
      <div class="step-nav">
        <button type="button" class="btn btn-outline-secondary btn-sm prev-step" data-prev="1">Back to Scenario</button>
        <button type="button" class="btn btn-primary btn-sm next-step" data-next="3">Proceed to Assessment</button>
      </div>
    </section>

    <section class="lab-step p-4" id="step-3" data-step="3">
      <h2 class="fw-semibold mb-4">Step 3 ¬∑ Multiple-Choice Assessment (MCA)</h2>
      <p class="text-secondary">Answer each question based on the scenario and artefacts provided. Use the feedback buttons or expand the answer keys to validate your understanding.</p>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">Question 1 ¬∑ Domain Comparison</h3>
        <p class="text-secondary mb-2">Which observation most clearly proves the message originated from an impersonated domain?</p>
        <ul class="text-secondary">
          <li>A. The email mentions a payment portal.</li>
          <li>B. The sender address ends with <strong>northwind-payments.co</strong> instead of <strong>northwind-payments.com</strong>.</li>
          <li>C. The footer includes a support phone number.</li>
          <li>D. The salutation uses the recipient's name.</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
            <label class="form-check-label" for="q1a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
            <label class="form-check-label" for="q1b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
            <label class="form-check-label" for="q1c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
            <label class="form-check-label" for="q1d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>B</strong> ‚Äî the attacker registered the <code>.co</code> variant to mimic the legitimate <code>.com</code> domain.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">Question 2 ¬∑ Registration Timing</h3>
        <p class="text-secondary mb-2">Why is the WHOIS creation date a strong indicator of malicious intent?</p>
        <ul class="text-secondary">
          <li>A. Legitimate vendors rotate domains every week.</li>
          <li>B. Newly registered domains are commonly used in phishing before reputation systems catch up.</li>
          <li>C. Older domains cannot host phishing content.</li>
          <li>D. WHOIS data always reveals the attacker‚Äôs real name.</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
            <label class="form-check-label" for="q2a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
            <label class="form-check-label" for="q2b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
            <label class="form-check-label" for="q2c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
            <label class="form-check-label" for="q2d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>B</strong> ‚Äî attackers exploit freshly registered domains before reputation services can flag them.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">Question 3 ¬∑ Redirect Behaviour</h3>
        <p class="text-secondary mb-2">What risk does the observed redirect to <code>http://198.51.100.43/login</code> present?</p>
        <ul class="text-secondary">
          <li>A. It ensures the connection is encrypted end-to-end.</li>
          <li>B. It downgrades the session to cleartext HTTP where credentials can be intercepted.</li>
          <li>C. It provides faster performance for global users.</li>
          <li>D. It guarantees the page is cached for offline access.</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
            <label class="form-check-label" for="q3a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
            <label class="form-check-label" for="q3b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
            <label class="form-check-label" for="q3c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
            <label class="form-check-label" for="q3d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>B</strong> ‚Äî the downgrade removes TLS protection, exposing any submitted data.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">Question 4 ¬∑ Certificate Review</h3>
        <p class="text-secondary mb-2">How can the certificate information help differentiate the fake site from the legitimate portal?</p>
        <ul class="text-secondary">
          <li>A. The fake site uses a certificate issued to privacy-guarded details, unlike the EV certificate on the real portal.</li>
          <li>B. Certificates are unrelated to identifying phishing sites.</li>
          <li>C. The fake site disables certificate pinning by default.</li>
          <li>D. All certificates list the full source code of the website.</li>
        </ul>
        <form class="mcq-form" data-answer="a">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q4" id="q4a" value="a">
            <label class="form-check-label" for="q4a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
            <label class="form-check-label" for="q4b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q4" id="q4c" value="c">
            <label class="form-check-label" for="q4c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="q4" id="q4d" value="d">
            <label class="form-check-label" for="q4d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>A</strong> ‚Äî legitimate portals typically present organisation-validated certificates that display company details.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">Question 5 ¬∑ Response Action</h3>
        <p class="text-secondary mb-2">What is the most appropriate response after confirming the domain is malicious?</p>
        <ul class="text-secondary">
          <li>A. Submit credentials to test if the site is safe.</li>
          <li>B. Ignore the finding because the certificate is valid.</li>
          <li>C. Report the message to security operations and contact the vendor through verified channels.</li>
          <li>D. Share the URL with the attacker for confirmation.</li>
        </ul>
        <form class="mcq-form" data-answer="c">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q5" id="q5a" value="a">
            <label class="form-check-label" for="q5a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
            <label class="form-check-label" for="q5b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q5" id="q5c" value="c">
            <label class="form-check-label" for="q5c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="q5" id="q5d" value="d">
            <label class="form-check-label" for="q5d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>C</strong> ‚Äî escalate to security and use trusted vendor channels to confirm account status.</div>
        </details>
      </div>

      <div class="knowledge-card p-4">
        <h3 class="h5">Question 6 ¬∑ Flag Capture</h3>
        <p class="text-secondary mb-2">Record the completion flag once you have validated each investigative step.</p>
        <ul class="text-secondary">
          <li>A. FLAG-DOMAIN-TRUSTED</li>
          <li>B. FLAG-URL-VERIFIED</li>
          <li>C. FLAG-NORTHWIND-SECURE</li>
          <li>D. FLAG-PORTAL-RESET</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q6" id="q6a" value="a">
            <label class="form-check-label" for="q6a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q6" id="q6b" value="b">
            <label class="form-check-label" for="q6b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="q6" id="q6c" value="c">
            <label class="form-check-label" for="q6c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="q6" id="q6d" value="d">
            <label class="form-check-label" for="q6d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-banner">Completion Flag: <strong>FLAG-URL-VERIFIED</strong></div>
          <p class="text-secondary mt-3 mb-0">Log this flag in your training tracker to complete Lab 2.</p>
        </details>
      </div>
    </section>

    <section class="mt-5">
      <h2 class="h4 text-center mb-4">Standalone MCQ Review</h2>
      <p class="text-secondary text-center mb-5">Prefer to answer without the stepper? Use the same question set below to check your understanding.</p>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">MCQ 1 ¬∑ Domain Comparison</h3>
        <p class="text-secondary mb-2">Which observation most clearly proves the message originated from an impersonated domain?</p>
        <ul class="text-secondary">
          <li>A. The email mentions a payment portal.</li>
          <li>B. The sender address ends with <strong>northwind-payments.co</strong> instead of <strong>northwind-payments.com</strong>.</li>
          <li>C. The footer includes a support phone number.</li>
          <li>D. The salutation uses the recipient's name.</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq1" id="sq1a" value="a">
            <label class="form-check-label" for="sq1a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq1" id="sq1b" value="b">
            <label class="form-check-label" for="sq1b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq1" id="sq1c" value="c">
            <label class="form-check-label" for="sq1c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="sq1" id="sq1d" value="d">
            <label class="form-check-label" for="sq1d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>B</strong> ‚Äî the attacker registered the <code>.co</code> variant to mimic the legitimate <code>.com</code> domain.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">MCQ 2 ¬∑ Registration Timing</h3>
        <p class="text-secondary mb-2">Why is the WHOIS creation date a strong indicator of malicious intent?</p>
        <ul class="text-secondary">
          <li>A. Legitimate vendors rotate domains every week.</li>
          <li>B. Newly registered domains are commonly used in phishing before reputation systems catch up.</li>
          <li>C. Older domains cannot host phishing content.</li>
          <li>D. WHOIS data always reveals the attacker‚Äôs real name.</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq2" id="sq2a" value="a">
            <label class="form-check-label" for="sq2a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq2" id="sq2b" value="b">
            <label class="form-check-label" for="sq2b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq2" id="sq2c" value="c">
            <label class="form-check-label" for="sq2c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="sq2" id="sq2d" value="d">
            <label class="form-check-label" for="sq2d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>B</strong> ‚Äî attackers exploit freshly registered domains before reputation services can flag them.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">MCQ 3 ¬∑ Redirect Behaviour</h3>
        <p class="text-secondary mb-2">What risk does the observed redirect to <code>http://198.51.100.43/login</code> present?</p>
        <ul class="text-secondary">
          <li>A. It ensures the connection is encrypted end-to-end.</li>
          <li>B. It downgrades the session to cleartext HTTP where credentials can be intercepted.</li>
          <li>C. It provides faster performance for global users.</li>
          <li>D. It guarantees the page is cached for offline access.</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq3" id="sq3a" value="a">
            <label class="form-check-label" for="sq3a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq3" id="sq3b" value="b">
            <label class="form-check-label" for="sq3b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq3" id="sq3c" value="c">
            <label class="form-check-label" for="sq3c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="sq3" id="sq3d" value="d">
            <label class="form-check-label" for="sq3d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>B</strong> ‚Äî the downgrade removes TLS protection, exposing any submitted data.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">MCQ 4 ¬∑ Certificate Review</h3>
        <p class="text-secondary mb-2">How can the certificate information help differentiate the fake site from the legitimate portal?</p>
        <ul class="text-secondary">
          <li>A. The fake site uses a certificate issued to privacy-guarded details, unlike the EV certificate on the real portal.</li>
          <li>B. Certificates are unrelated to identifying phishing sites.</li>
          <li>C. The fake site disables certificate pinning by default.</li>
          <li>D. All certificates list the full source code of the website.</li>
        </ul>
        <form class="mcq-form" data-answer="a">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq4" id="sq4a" value="a">
            <label class="form-check-label" for="sq4a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq4" id="sq4b" value="b">
            <label class="form-check-label" for="sq4b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq4" id="sq4c" value="c">
            <label class="form-check-label" for="sq4c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="sq4" id="sq4d" value="d">
            <label class="form-check-label" for="sq4d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>A</strong> ‚Äî legitimate portals typically present organisation-validated certificates that display company details.</div>
        </details>
      </div>

      <div class="knowledge-card p-4 mb-4">
        <h3 class="h5">MCQ 5 ¬∑ Response Action</h3>
        <p class="text-secondary mb-2">What is the most appropriate response after confirming the domain is malicious?</p>
        <ul class="text-secondary">
          <li>A. Submit credentials to test if the site is safe.</li>
          <li>B. Ignore the finding because the certificate is valid.</li>
          <li>C. Report the message to security operations and contact the vendor through verified channels.</li>
          <li>D. Share the URL with the attacker for confirmation.</li>
        </ul>
        <form class="mcq-form" data-answer="c">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq5" id="sq5a" value="a">
            <label class="form-check-label" for="sq5a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq5" id="sq5b" value="b">
            <label class="form-check-label" for="sq5b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq5" id="sq5c" value="c">
            <label class="form-check-label" for="sq5c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="sq5" id="sq5d" value="d">
            <label class="form-check-label" for="sq5d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-pill mt-3">Correct: <strong>C</strong> ‚Äî escalate to security and use trusted vendor channels to confirm account status.</div>
        </details>
      </div>

      <div class="knowledge-card p-4">
        <h3 class="h5">MCQ 6 ¬∑ Flag Capture</h3>
        <p class="text-secondary mb-2">Record the completion flag once you have validated each investigative step.</p>
        <ul class="text-secondary">
          <li>A. FLAG-DOMAIN-TRUSTED</li>
          <li>B. FLAG-URL-VERIFIED</li>
          <li>C. FLAG-NORTHWIND-SECURE</li>
          <li>D. FLAG-PORTAL-RESET</li>
        </ul>
        <form class="mcq-form" data-answer="b">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq6" id="sq6a" value="a">
            <label class="form-check-label" for="sq6a">A</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq6" id="sq6b" value="b">
            <label class="form-check-label" for="sq6b">B</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sq6" id="sq6c" value="c">
            <label class="form-check-label" for="sq6c">C</label>
          </div>
          <div class="form-check mb-3">
            <input class="form-check-input" type="radio" name="sq6" id="sq6d" value="d">
            <label class="form-check-label" for="sq6d">D</label>
          </div>
          <button type="button" class="btn btn-outline-primary btn-sm check-answer">Check Answer</button>
          <div class="mcq-feedback small mt-2" aria-live="polite"></div>
        </form>
        <details class="mt-3">
          <summary>Reveal answer</summary>
          <div class="flag-banner">Completion Flag: <strong>FLAG-URL-VERIFIED</strong></div>
          <p class="text-secondary mt-3 mb-0">Log this flag in your training tracker to complete Lab 2.</p>
        </details>
      </div>
    </section>

    <section class="lab-modules mt-5" id="modules">
      <h2 class="h4 text-center mb-2">Detailed Lab Modules</h2>
      <p class="text-secondary text-center mb-5">Follow this TryHackMe-style breakdown to reinforce URL and domain analysis fundamentals.</p>

      <div class="module-card row g-0 align-items-stretch">
        <div class="col-md-5">
          <img src="https://images.unsplash.com/photo-1556157382-97eda2d62296?auto=format&fit=crop&w=900&q=80" alt="Analyst reviewing email headers" loading="lazy">
        </div>
        <div class="col-md-7">
          <div class="module-body h-100 d-flex flex-column">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span class="badge text-bg-primary">Module 01</span>
              <span class="text-secondary small">Est. time: 10 minutes</span>
            </div>
            <h3 class="h5">Email & Header Reconnaissance</h3>
            <p class="text-secondary">Extract sender domains, evaluate SPF results, and document red flags before interacting with any links.</p>
            <ul class="text-secondary small mb-4">
              <li class="mb-2">Compare claimed domains with trusted vendor records.</li>
              <li class="mb-2">Identify authentication failures such as SPF softfail.</li>
              <li>Catalogue urgency language used to pressure the recipient.</li>
            </ul>
            <span class="badge rounded-pill text-bg-light text-secondary mt-auto">Skills: Email forensics ¬∑ Threat hunting ¬∑ Vendor validation</span>
          </div>
        </div>
      </div>

      <div class="module-card row g-0 align-items-stretch">
        <div class="col-md-5 order-md-2">
          <img src="https://images.unsplash.com/photo-1545239351-1141bd82e8a6?auto=format&fit=crop&w=900&q=80" alt="Browser developer tools inspection" loading="lazy">
        </div>
        <div class="col-md-7 order-md-1">
          <div class="module-body h-100 d-flex flex-column">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span class="badge text-bg-primary">Module 02</span>
              <span class="text-secondary small">Est. time: 15 minutes</span>
            </div>
            <h3 class="h5">Inspect Live URL Signals</h3>
            <p class="text-secondary">Load the suspicious link in a controlled environment to capture certificate data, redirects, and DNS indicators.</p>
            <ul class="text-secondary small mb-4">
              <li class="mb-2">Validate certificate issuers and subject fields.</li>
              <li class="mb-2">Trace redirect chains for protocol downgrades.</li>
              <li>Correlate passive DNS with previously blocked infrastructure.</li>
            </ul>
            <span class="badge rounded-pill text-bg-light text-secondary mt-auto">Skills: TLS review ¬∑ Redirect tracing ¬∑ DNS intelligence</span>
          </div>
        </div>
      </div>

      <div class="module-card row g-0 align-items-stretch mb-0">
        <div class="col-md-5">
          <img src="https://images.unsplash.com/photo-1521737604893-d14cc237f11d?auto=format&fit=crop&w=900&q=80" alt="Team discussing incident response" loading="lazy">
        </div>
        <div class="col-md-7">
          <div class="module-body h-100 d-flex flex-column">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <span class="badge text-bg-primary">Module 03</span>
              <span class="text-secondary small">Est. time: 8 minutes</span>
            </div>
            <h3 class="h5">Respond &amp; Report</h3>
            <p class="text-secondary">Coordinate with security operations, notify the vendor through trusted channels, and log the completion flag.</p>
            <ul class="text-secondary small mb-4">
              <li class="mb-2">Escalate phishing indicators with documented artefacts.</li>
              <li class="mb-2">Request takedown assistance if the clone remains live.</li>
              <li>Share lessons learned to improve vendor validation workflows.</li>
            </ul>
            <span class="badge rounded-pill text-bg-light text-secondary mt-auto">Skills: Incident communication ¬∑ Vendor coordination ¬∑ Knowledge retention</span>
          </div>
        </div>
      </div>
    </section>


    <footer class="text-center small mt-5 pb-4">
      <p class="mb-1">Trust but verify ‚Äî confirm every URL before entering credentials or payment data.</p>
      <p class="mb-0">Phishing Awareness Labs ¬© 2024</p>
    </footer>
  </div>
  <script>
    (function () {
      var steps = Array.from(document.querySelectorAll('.lab-step'));
      var trackerSteps = Array.from(document.querySelectorAll('.tracker-step'));

      function showStep(stepNumber) {
        var target = stepNumber.toString();
        steps.forEach(function (step) {
          var isActive = step.dataset.step === target;
          if (isActive) {
            step.removeAttribute('hidden');
          }
          step.classList.toggle('active', isActive);
          step.setAttribute('aria-hidden', isActive ? 'false' : 'true');
        });
        trackerSteps.forEach(function (item) {
          var itemStep = item.dataset.step;
          item.classList.toggle('active', itemStep === target);
          item.setAttribute('aria-current', itemStep === target ? 'step' : 'false');
          if (Number(itemStep) < Number(target)) {
            item.classList.add('completed');
          } else {
            item.classList.remove('completed');
          }
        });
        var activeStep = steps.find(function (step) {
          return step.dataset.step === target;
        });
        if (activeStep) {
          activeStep.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
      }

      document.querySelectorAll('.next-step').forEach(function (button) {
        button.addEventListener('click', function () {
          var next = button.dataset.next;
          if (next) {
            showStep(next);
          }
        });
      });

      document.querySelectorAll('.prev-step').forEach(function (button) {
        button.addEventListener('click', function () {
          var prev = button.dataset.prev;
          if (prev) {
            showStep(prev);
          }
        });
      });

      document.querySelectorAll('.jump-step').forEach(function (button) {
        button.addEventListener('click', function () {
          var target = button.dataset.target;
          if (target) {
            showStep(target);
          }
        });
      });

      trackerSteps.forEach(function (item) {
        item.addEventListener('click', function () {
          showStep(item.dataset.step);
        });
      });

      document.querySelectorAll('.mcq-form').forEach(function (form) {
        var button = form.querySelector('.check-answer');
        var feedback = form.querySelector('.mcq-feedback');
        var correct = form.dataset.answer;
        if (button && feedback) {
          button.addEventListener('click', function () {
            var selected = form.querySelector('input[type="radio"]:checked');
            if (!selected) {
              feedback.textContent = 'Select an option to check your answer.';
              feedback.classList.remove('correct', 'incorrect');
              return;
            }
            if (selected.value === correct) {
              feedback.textContent = 'Correct answer!';
              feedback.classList.add('correct');
              feedback.classList.remove('incorrect');
            } else {
              feedback.textContent = 'That is not correct. Review the scenario and try again.';
              feedback.classList.add('incorrect');
              feedback.classList.remove('correct');
            }
          });
        }
      });

      var indicatorChecks = Array.from(document.querySelectorAll('.indicator-check'));
      var indicatorStatus = document.querySelector('.indicator-status');

      function updateIndicatorStatus() {
        if (!indicatorStatus) {
          return;
        }
        var checkedCount = indicatorChecks.filter(function (check) {
          return check.checked;
        }).length;
        var total = indicatorChecks.length;
        if (checkedCount === 0) {
          indicatorStatus.textContent = 'Mark the clues above as you validate each red flag.';
        } else if (checkedCount === total) {
          indicatorStatus.textContent = 'All red flags logged. Continue to the URL artefacts when ready.';
        } else {
          indicatorStatus.textContent = checkedCount + ' of ' + total + ' red flags identified.';
        }
      }

      indicatorChecks.forEach(function (check) {
        check.addEventListener('change', updateIndicatorStatus);
      });

      updateIndicatorStatus();

      var artefactTabs = Array.from(document.querySelectorAll('.artefact-tab'));
      var artefactPanels = Array.from(document.querySelectorAll('.artefact-panel'));
      var artefactStatus = document.querySelector('.artefact-status');
      var viewedPanels = new Set();

      function updateArtefactStatus() {
        if (!artefactStatus) {
          return;
        }
        var total = artefactPanels.length;
        var viewed = viewedPanels.size;
        if (viewed === 0) {
          artefactStatus.textContent = 'Select a tab to inspect the supporting evidence.';
        } else if (viewed === total) {
          artefactStatus.textContent = 'All artefacts reviewed. You are ready for the assessment.';
        } else {
          artefactStatus.textContent = viewed + ' of ' + total + ' artefacts reviewed.';
        }
      }

      function showArtefact(panelId) {
        artefactPanels.forEach(function (panel) {
          var isActive = panel.id === panelId;
          panel.classList.toggle('active', isActive);
          panel.setAttribute('aria-hidden', isActive ? 'false' : 'true');
          if (isActive) {
            viewedPanels.add(panelId);
          }
        });
        artefactTabs.forEach(function (tab) {
          var isActive = tab.dataset.panel === panelId;
          tab.classList.toggle('active', isActive);
          tab.setAttribute('aria-pressed', isActive ? 'true' : 'false');
        });
        updateArtefactStatus();
      }

      artefactTabs.forEach(function (tab) {
        tab.addEventListener('click', function () {
          showArtefact(tab.dataset.panel);
        });
      });

      showArtefact('panel-address');
      showStep('1');
    })();
  </script>
</body>
</html>
